import { NextRequest, NextResponse } from 'next/server';import { supabaseServer } from '../../../../../lib/supabase';export async function POST(req: NextRequest,{ params }:{ params:{ id:string }}){const s=supabaseServer();try{const userId=req.headers.get('x-user-id');if(!userId) return NextResponse.json({error:'Missing user'},{status:401});const eventId=Number(params.id);const { error }=await s.from('registrations').insert({event_id:eventId,user_id:userId});if(error) throw error;return NextResponse.redirect(new URL(`/events/${eventId}?registered=1`,req.url),303);}catch(e:any){return NextResponse.json({error:e.message},{status:500});}}