import { NextRequest, NextResponse } from 'next/server';import { supabaseServer } from '../../../lib/supabase';export async function POST(req: NextRequest){const s=supabaseServer();const form=await req.formData();const eventIdStr=form.get('event_id') as string;const eventId=Number(eventIdStr);if(!eventId) return NextResponse.json({error:'Missing event_id'},{status:400});const { error }=await s.rpc('promote_from_waitlist',{ p_event_id:eventId });if(error) return NextResponse.json({error:error.message},{status:400});return NextResponse.redirect(new URL(`/events/${eventId}?promoted=1`,req.url),303);}