import { supabaseServer } from '../../lib/supabase';import Link from 'next/link';export const dynamic='force-dynamic';export default async function Admin(){const s=supabaseServer();const {data:candidates}=await s.from('eligibility_candidates').select('*').order('eligible',{ascending:false});const {data:events}=await s.from('events').select('*').gte('start_time',new Date().toISOString()).order('start_time',{ascending:true}).limit(20);return (<div><h1>Admin Dashboard</h1><section className="card" style={{marginTop:'1rem'}}><h2>Membership Eligibility</h2><p>Rule: attend ≥1 meeting and ≥2 trips.</p><div className="grid">{(candidates||[]).map((c:any)=>(<div key={c.user_id} className="card"><h3>{c.name}</h3><p>{c.email}</p><p>Meetings: {c.meetings_attended} · Trips: {c.trips_attended}</p><p>Status: {c.eligible ? '✅ Eligible' : '⏳ Not yet'}</p><form action="/api/admin/promote" method="post" style={{display:'inline-block',marginRight:'0.5rem'}}><input type="hidden" name="user_id" value={c.user_id}/><input type="hidden" name="role" value="member"/><button className="btn" type="submit" disabled={!c.eligible}>Set as Member</button></form><form action="/api/admin/promote" method="post" style={{display:'inline-block'}}><input type="hidden" name="user_id" value={c.user_id}/><input type="hidden" name="role" value="admin"/><button className="btn" type="submit">Make Admin</button></form></div>))}</div></section><section className="card" style={{marginTop:'1rem'}}><h2>Events quick view</h2><div className="grid">{(events||[]).map((e:any)=>(<div key={e.id} className="card"><h3>{e.title}</h3><p>{new Date(e.start_time).toLocaleString()} — {e.location||'TBA'}</p><p>Type: {e.event_type || 'trip'} · Capacity: {e.capacity || '∞'}</p><Link className="btn" href={`/events/${e.id}`}>Open</Link><form style={{display:'inline-block',marginLeft:'0.5rem'}} action="/api/admin/promote-waitlist" method="post"><input type="hidden" name="event_id" value={e.id}/><button className="btn" type="submit">Promote from waitlist</button></form></div>))}</div></section></div>);}